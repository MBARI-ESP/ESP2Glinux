# since we're using devfsd, we need to initialize /dev symlinks on every reboot
cd /dev

#leave interrupts unmasked on IDE accesses so we don't lose serial input
[ hd[a-z] = 'hd[a-z]' ] || hdparm -u1k1 hd[a-z] >null

i2cGate()
{
  name=$1; port=$2
  ln -s $port $name 
  chgrp tty $port && chmod g+rw $port
}

freewave= #tts/15 #serial port connected to the freewave radio modem
[ -c "$freewave" ] && {
  ln -s $freewave freewave
  stty -F freewave 19200 clocal raw -echo -echonl  #for modem configuration
  modprobe ppp_async && modprobe ppp_deflate    #support for the ppp deamon
}

[ -d tts ] && {
  for port in $I2Cgate tts/* ; do
    [ $port = "$freewave" ] && continue  #freewave may not be touched by users
    chgrp tty $port && chmod g+rw $port
  done
}

#i2cGate I2Cgate tts/11   #core ESP gateway
#i2cGate DWSMgate tts/14  #Deep Water Sampler

