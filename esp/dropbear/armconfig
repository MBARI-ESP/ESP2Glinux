#!/bin/bash
# unpack, patch and configure dropbear-git build for arm-linux 
#  -- 6/22/17 brent@mbari.org
: ${CFLAGS:=-Os}
: ${CXXFLAGS:=$CFLAGS}
: ${ARMGCC:=/arm}
: ${CC:=$ARMGCC/bin/gcc}
: ${LIBTOP:=${1-$ARMGCC/usr}}
: ${DBVERS:=dropbear-git}
export CC CFLAGS CXXFLAGS
unset zlib
[ "$ARMPREFIX" ] && zlib="--with-zlib=$ARMPREFIX"
cd $DBVERS && 
git reset --hard &&
git clean -dxf &&
git checkout DROPBEAR_2017.75 &&
patch < ../dropbear-mbari1.patch &&
autoconf && autoheader &&
configure --host=arm-unknown-linux $zlib \
 --disable-lastlog --disable-utmp --disable-utmpx \
 --disable-wtmp --disable-wtmpx --disable-pututline --disable-pututxline &&
echo "Next, run arminstall here"
