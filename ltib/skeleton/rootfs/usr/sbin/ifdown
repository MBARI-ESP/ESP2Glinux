#!/bin/sh
#
#  ifdown [interface name]
#

case "$1" in
  -*|*/*|'') #any flag is a request for help
    cat <<END >&2
usage:  ifdown [network interface or alias name]
        deconfigure and disable the specified network interface or alias
END
    exit 1
  ;;
esac

. /usr/share/netutils.sh

tracefn=/tmp/ifdown.trace
if [ -w $tracefn ]; then
  (date; echo "$@"; env) >>$tracefn
  exec 2>>$tracefn
  set -x
fi

op=down
case "$1" in
  *:*) #an interface alias
  ;;

  *) #anything else must be the name of an interface
    [ "$2" = "force" ] && eachAlias ifDown $1
    isUp "$1:[[:digit:]][[:digit:]]*" && op=0   #leave UP if UP aliases remain
esac
trap "gateUp; hostsUp; gateUpdated" EXIT TERM INT HUP QUIT
ifDown $1 $op
